<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head thy:merge="/common::headerFragment">
<title>统计列表</title>
<meta http-equiv="Content-Type" content="text/html; charset=GB2312" />
<script src="/bootstrap/js/plugins/jqplot.json2.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.json2.min.js}"></script>
<script src="/bootstrap/js/plugins/jqplot.barRenderer.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.barRenderer.min.js}"></script>
<script src="/bootstrap/js/plugins/jqplot.categoryAxisRenderer.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.categoryAxisRenderer.min.js}"></script>
<script src="/bootstrap/js/plugins/jqplot.pointLabels.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.pointLabels.min.js}"></script>
<script src="/bootstrap/js/plugins/jqplot.dateAxisRenderer.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.dateAxisRenderer.min.js}"></script>
<script src="/bootstrap/js/plugins/jqplot.canvasTextRenderer.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.canvasTextRenderer.min.js}"></script>
<script src="/bootstrap/js/plugins/jqplot.canvasAxisTickRenderer.min.js"
	type="text/javascript"
	th:src="@{/bootstrap/js/plugins/jqplot.canvasAxisTickRenderer.min.js}"></script>
<script type="text/javascript" src="../excanvas.compiled.js"
	th:src="@{/bootstrap/js/excanvas.compiled.js}"></script>
<script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
    function rowRender(data) {
	var newRow = "<tr>";

	newRow += "<td>" + data.submitDepartment + "</td>";
	newRow += "<td>" + data.applicationName + "</td>";
	newRow += "<td>" + data.formOfResponse + "</td>";

	newRow += "</tr>";
	return newRow;
    };
    $(document)
	    .ready(
		    function() {
			$("#submitButton")
				.click(
					function() {

					    $
						    .ajax({
							type : "POST", //提交的类型
							dataType : "json",
							contentType : "application/x-www-form-urlencoded; charset=GB2312",
							data : {
							    'applicantName' : $(
								    '#applicantName')
								    .val(),
							    'startTime' : new Date(
								    $(
									    "#startTimePicker")
									    .data(
										    'datetimepicker')
									    .getLocalDate())
								    .ToString(),
							    'endTime' : new Date(
								    $(
									    "#endTimePicker")
									    .data(
										    'datetimepicker')
									    .getLocalDate())
								    .ToString()
							},
							url : /*[[@{'/statistical/analyseByApplicant'}]]*/"", //提交地址
							success : function(data) {

							    $("#analyseTable")
								    .find("tr")
								    .nextAll()
								    .remove();
							    for (i = 0; i < data.records.length; i++) {
								var newRow = rowRender(data.records[i]);
								$(
									"#analyseTable")
									.find(
										"tr:last")
									.after(
										newRow);
								// $("#permissionList
								// tr:last").after(newRow);

							    }
							}
						    });
					});

			$("#startTimePicker").datetimepicker({
			    language : 'zh-CN',
			    format : 'yyyy-MM-dd hh:mm:ss',
			    pickDate : true,
			    pickTime : true,
			    hourStep : 1,
			    minuteStep : 15,
			    secondStep : 30,
			    inputMask : true
			});
			$("#endTimePicker").datetimepicker({
			    language : 'zh-CN',
			    format : 'yyyy-MM-dd hh:mm:ss',
			    pickDate : true,
			    pickTime : true,
			    hourStep : 1,
			    minuteStep : 15,
			    secondStep : 30,
			    inputMask : true
			});

		    });
    /*]]>*/
</script>
<style>
.hover {
	background-color: #cccc00;
}
</style>
</head>
<body>
	<div>
		<form class="form-inline">
			<div class="control-group">
				<div class="row">
					<div class="span9">
						<div class="controls">
							<label class="control-label text-info">申请人：</label>
							<div class="input-append date">
								<input name="applicantName" id="applicantName" />
							</div>
							<label class="control-label text-info">开始时间：</label>
							<div id="startTimePicker" class="input-append date">
								<input name="startTime" class="datepicker"
									data-date-format="yyyy-MM-dd hh:mm:ss" /> <span class="add-on">
									<i data-time-icon="icon-time" data-date-icon="icon-calendar">
								</i>
								</span>
							</div>
							<label class="control-label text-info">结束时间：</label>
							<div id="endTimePicker" class="input-append date">
								<input name="endTime" class="datepicker"
									data-date-format="yyyy-MM-dd hh:mm:ss" /> <span class="add-on">
									<i data-time-icon="icon-time" data-date-icon="icon-calendar">
								</i>
								</span>
							</div>
							<input type="button" id="submitButton" value="提交"
								class="btn btn-primary" />
						</div>
					</div>
				</div>
			</div>
		</form>
		<table id="analyseTable"
			class="table table-bordered table-striped table-condensed">
			<tr>
				<th>提交部门</th>
				<th>申请事项</th>
				<th>结果</th>
			</tr>
		</table>
	</div>
</body>
</html>
