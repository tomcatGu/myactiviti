<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head thy:merge="/common::headerFragment">
<title>任务列表</title>
<script type="text/javascript" th:inline="javascript">
    /*<![CDATA[*/
    function render(data) {
	var newRow = "<tr><td><input type=\"checkbox\" /></td><td>" + data.id
		+ "</td><td>" + data.name + "</td><td>" + data.assignee
		+ "</td><td><a href=\"javascript:loadView('"
		+ /*[[@{'/runtime/tasks/claim/'}]]*/"1234/" //url
		+ data.id + "')\">接受</a></td></tr>";
	return newRow;
    };
    $(document)
	    .ready(
		    function() {

			$("#taskList")
				.simpleTable(
					/*[[@{'/runtime/tasks/listTasks?sort=name&order=desc'}]]*/""
						+ "&timestamp="
						+ new Date().toString(),
					render, $("#paginatorForTaskList"),
					null);

		    });
    function loadView(url) {
	$("#view")
		.load(
			url + '?' + (new Date()).valueOf(),
			function(data) {
			    $("#view")
				    .bind(
					    "evtWFSuccess",
					    function(evt, data) {
						$("#view").hide();
						$("#taskList")
							.clearSimpleTable();
						$("#listView").show();
						$("#taskList")
							.simpleTable(
								/*[[@{'/runtime/tasks/listTasks?sort=name&order=desc'}]]*/"",
								render,
								$("#paginatorForTaskList"),
								null);

					    });
			    $("#view").show();
			    $("#listView").hide();

			});
    };
    /*]]>*/
</script>
<style>
.hover {
	background-color: #cccc00;
}
</style>
</head>
<body>
	<div class="box" id="listView">
		<table id="taskList" cellpadding="0" cellspacing="0" border="0"
			class="table table-striped table-bordered table-hover">
			<thead>
				<tr>
					<th><input type="checkbox" name="check" value="" /></th>
					<th>任务ID</th>
					<th>任务名称</th>
					<th>任务实施者</th>
					<th>动作</th>
				</tr>
			</thead>
			<tbody>
				<tr th:each="task:${tasks}">
					<td><input type="checkbox" name="check" value="" /></td>
					<td>id</td>
					<td>name</td>
					<td>assignee</td>
					<td>action</td>
				</tr>
			</tbody>
		</table>
		<div id="paginatorForTaskList"></div>
		<input type="button" id="deleteBtn" value="删除选中"
			class="btn btn-danger" />
	</div>
	<div id="view"></div>
	<div tabindex="-1" class="modal hide fade" id="selectUsers"
		data-keyboard="false" data-backdrop="static"></div>
</body>
</html>
