<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head thy:merge="/common::headerFragment">
<title>Government Infomation Disclosure</title>
<meta http-equiv="Content-Type" content="text/html; charset=GB2312" />
<script type="text/javascript" th:inline="javascript">
	/*<![CDATA[*/
	function load(title, url) {
		$("#content")
				.load(
						url + '?' + (new Date()).valueOf(),
						function(event) {
							$('#breadcrumb').empty();
							$('#breadcrumb')
									.append(
											'<li><a href="#">首页</a> <span class="divider">/</span></li>');
							$('#breadcrumb').append(
									'<li class="active">' + title + '</li>');

						});
		$("#content").bind("evtWFSuccess", function(evt, data) {
			load('所有流程', 'runtime/process/userProcessIndex/admin');
		});

	};
	function changePassword() {
		create('#changePasswordDialog', /*[[@{'/user/changePassword'}]]*/'',
				successCallback);
	};
	function successCallback() {

		$("#changePasswordDialog").modal("hide");

	};
	$(document).ready(function() {

		//ajaxify menus
		$('ul.nav a').click(function(e) {
			/*
			if($.browser.msie) e.which=1;
			if(e.which!=1 || !$('#is-ajax').prop('checked') || $(this).parent().hasClass('active')) return;
			e.preventDefault();
			if($('.btn-navbar').is(':visible'))
			{
				$('.btn-navbar').click();
			}
			$('#loading').remove();
			$('#content').fadeOut().parent().append('<div id="loading" class="center">Loading...<div class="center"></div></div>');
			 */
			var $clink = $(this);
			//History.pushState(null, null, $clink.attr('href'));
			$('ul li.active').removeClass('active');
			$clink.parent('li').addClass('active');

		});
		$('.dropdown-toggle').dropdown();
		//animating menus on hover
		$('ul.nav li:not(.nav-header)').hover(function() {
			$(this).animate({
				'margin-left' : '+=5'
			}, 300);
		}, function() {
			$(this).animate({
				'margin-left' : '-=5'
			}, 300);
		});

		load('待办', 'runtime/tasks/index');

	});
	/*]]>*/
</script>
</head>
<body>
	<div class="span12">
		<div class="navbar navbar-inverse navbar-fixed-top showgrid">
			<div class="navbar-inner">
				<div class="container-fluid">
					<button type="button" class="btn btn-navbar" data-toggle="collapse"
						data-target=".nav-collapse">
						<span class="icon-bar"></span> <span class="icon-bar"></span> <span
							class="icon-bar"></span>
					</button>
					<a class="brand" href="#">政府信息公开管理系统</a>
					<div class="nav-collapse collapse">
						<div class="btn-group pull-right">
							<button class="btn btn-info"
								th:text="${T(org.apache.shiro.SecurityUtils).subject.principal}">login
								name</button>
							<button class="btn btn-info dropdown-toggle"
								data-toggle="dropdown">
								<span class="caret"></span>
							</button>
							<ul class="dropdown-menu">
								<li><a href="javascript:changePassword()">修改密码</a></li>
								<li class="divider"></li>
								<li><a th:href="@{/logout}">退出</a></li>
							</ul>
						</div>
						<ul class="nav">
							<li class="active"><a href="#"></a></li>
							<li><a href="#about"></a></li>
							<li><a href="#contact"></a></li>
						</ul>
					</div>
					<!--/.nav-collapse -->
				</div>
			</div>
		</div>
		<div class="container ">
			<div class="row">
				<div class="span3 bs-docs-sidebar">
					<div class="">
						<ul class="nav nav-list bs-docs-sidenav affix">
							<li class="nav-header">政府信息公开</li>
							<li><a href="#"
								th:if="${T(org.apache.shiro.SecurityUtils).subject.hasRole('ROLE_ADMIN')==true}"
								onClick="load('创建','runtime/process/governmentInformationDisclosure:5:176/start')">创建<i
									class="icon-chevron-right"></i></a></li>
							<li class="active"><a id="tasks"
								onclick="load('待办事项','runtime/tasks/index')">待办事项</a></li>
							<li><a href="#"
								onClick="load('已办事项','runtime/tasks/historicTasks')">已办事项</a></li>
							<li><a href="#"
								onClick="load('已办结','runtime/process/finishedProcessIndex/governmentInformationDisclosure:123:18208/')"
								th:if="${T(org.apache.shiro.SecurityUtils).subject.hasRole('ROLE_USER')==true}">已办结</a></li>
							<li><a href="#"
								onClick="load('所有流程','runtime/process/userProcessIndex/admin')">所有流程</a></li>
							<li class="nav-header">demo2</li>
							<li><a href="#" class="animation-fadeIn"><i
									class="icon-tasks"></i><span
									class="badge badge-success pull-right">3</span></a></li>
							<li class="nav-header"
								th:if="${T(org.apache.shiro.SecurityUtils).subject.hasRole('ROLE_ADMIN')==true}">用户管理</li>
							<li><a href="#" onClick="load('用户列表','user/index')"
								th:if="${T(org.apache.shiro.SecurityUtils).subject.hasRole('ROLE_ADMIN')==true}">用户列表<i
									class="icon-chevron-right"></i></a></li>
							<li class="nav-header">角色管理</li>
							<li><a href="#" onClick="load('角色列表','role/index')">角色列表<i
									class="icon-chevron-right"></i></a></li>
						</ul>
					</div>
					<!--/.well -->
				</div>
				<!--/span-->
				<div class="span9">
					<div class="row">
						<div class="span4"></div>
					</div>
					<ul class="breadcrumb" id="breadcrumb">
						<li><a href="#">首页</a> <span class="divider">/</span></li>
					</ul>
					<div id="content">
						<div class="container">
							<h1>欢迎!</h1>
							<p>这是一个政府公开信息系统.</p>
							<p>
								<a href="#" class="btn btn-primary btn-large">更多 &raquo;</a>
							</p>
						</div>
					</div>
				</div>
			</div>
			<!--/row-->
			<hr />
			<footer>
				<p>&copy; Company tomcat.gu@gmail.com</p>
			</footer>
		</div>
		<!--/.fluid-container-->
		<div tabindex="-1" class="modal hide fade" id="changePasswordDialog"
			data-keyboard="false" data-backdrop="static"></div>
	</div>
</body>
</html>